{% load static %}
<!-- Load Tailwind CSS CDN -->
<script src="https://cdn.tailwindcss.com"></script>
 <link rel="stylesheet" href="{% static 'story/css/style.css' %}?v=1.0">

    <link rel="stylesheet" href="{% static 'story/css/banner/banner.css' %}?v=1.0">
<script>
    // ƒê·ªãnh nghƒ©a c·∫•u h√¨nh m√†u Dark Mode v√† font Inter
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'primary': '#60a5fa', // Blue-400
                    'secondary': '#f97316', // Orange-500
                    'dark-bg-body': '#262626', // M√†u n·ªÅn #262626
                    'dark-bg-card': '#333333', // M√†u n·ªÅn card
                    'dark-border': '#4b5563', // Gray-600
                },
                fontFamily: {
                    sans: ['Inter', 'sans-serif'],
                },
            }
        }
    }
</script>

<!DOCTYPE html>
<html lang="vi">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö Danh s√°ch truy·ªán</title>
</head>

<body class="bg-dark-bg-body font-sans antialiased text-gray-100 min-h-screen">

    <!-- Gi·∫£ ƒë·ªãnh include header.html ƒë√£ ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi sang Tailwind -->
    {% include 'story/header/header.html' %}

    <!-- Gi·∫£ ƒë·ªãnh banner.html l√† n·ªôi dung ƒë∆∞·ª£c ch√®n v√†o ngay d∆∞·ªõi header -->
    {% include 'story/banner/banner.html' %}

    <div class="container mx-auto px-4 py-6 md:py-8 max-w-7xl">
        <h1 class="text-3xl font-extrabold text-white mb-6">
            üìö {{ page_title|default:"Danh s√°ch truy·ªán" }}
        </h1>
        
        <!-- B·ªë c·ª•c Grid Responsive (2 c·ªôt tr√™n mobile, 6 c·ªôt tr√™n desktop l·ªõn) -->
        <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 md:gap-6">
            {% for story in stories %}
            
                <div class="bg-dark-bg-card rounded-lg shadow-xl overflow-hidden 
                            hover:shadow-primary/50 hover:scale-[1.02] transition duration-300">
                    
                    <a href="{% url 'story_detail' story_id=story.pk %}" class="block">
                        <div class="card-image-wrapper aspect-w-3 aspect-h-4">
                            
                            <!-- ·∫¢nh b√¨a truy·ªán -->
                            {% if story.cover_image_url %}
                            <img src="{{ story.cover_image_url }}" 
                                 class="w-full h-full object-cover" 
                                 alt="{{ story.title }} - ·∫¢nh b√¨a"
                                 onerror="this.onerror=null; this.src='https://placehold.co/400x600/374151/FFFFFF?text=WEBSTORY';"
                            >
                            {% else %}
                            <div class="w-full h-full flex items-center justify-center bg-gray-700 text-gray-400">
                                Kh√¥ng c√≥ ·∫£nh
                            </div>
                            {% endif %}
                        </div>
                    </a>

                    <div class="p-3">
                        
                        <!-- Ti√™u ƒë·ªÅ truy·ªán -->
                        <h5 class="text-base font-semibold truncate mb-1">
                            <a href="{% url 'story_detail' story_id=story.pk %}" class="hover:text-primary text-white">
                                {{ story.title }}
                            </a>
                        </h5>

                        <!-- T√°c gi·∫£ -->
                        <p class="text-xs text-gray-400 truncate mb-2">T√°c gi·∫£: {{ story.author }}</p>

                        <!-- ƒê√°nh gi√° (Rating) -->
                        {% with rounded_rating=story.avg_rating|default:0|floatformat:0 %}
                        <div class="story-rating flex items-center text-sm">
                            <span class="text-yellow-400 mr-1">
                                
                                {# Hi·ªÉn th·ªã sao d·ª±a tr√™n rating #}
                                {% if rounded_rating >= 1 %}&#9733;{% else %}&#9734;{% endif %}
                                {% if rounded_rating >= 2 %}&#9733;{% else %}&#9734;{% endif %}
                                {% if rounded_rating >= 3 %}&#9733;{% else %}&#9734;{% endif %}
                                {% if rounded_rating >= 4 %}&#9733;{% else %}&#9734;{% endif %}
                                {% if rounded_rating >= 5 %}&#9733;{% else %}&#9734;{% endif %}
                            </span>
                            
                            <!-- Gi√° tr·ªã rating -->
                            <span class="rating-value text-gray-300 font-bold ml-1">
                                {{ story.avg_rating|default:"N/A"|floatformat:2 }}
                            </span>
                        </div>
                        {% endwith %}

                    </div>
                </div>
            {% empty %}
                <p class="col-span-full text-center text-gray-400 py-10 text-lg">Kh√¥ng t√¨m th·∫•y truy·ªán n√†o.</p>
            {% endfor %}
        </div>
        
        <!-- Logic ph√¢n trang (pagination) n·∫øu c√≥ s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
        
    </div>

    <!-- Gi·∫£ ƒë·ªãnh include footer.html ƒë√£ ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi sang Tailwind -->
    {% include 'story/footer/footer.html' %}

    <!-- Lo·∫°i b·ªè script tƒ©nh c·ªßa banner n·∫øu ƒë√£ chuy·ªÉn sang JS ho·∫∑c Tailwind -->
    <script src="{% static 'story/js/banner.js' %}"></script>

</body>

</html>
