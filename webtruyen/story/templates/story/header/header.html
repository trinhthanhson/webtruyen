{% load static %}
<!-- Load Tailwind CSS CDN -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
    // Định nghĩa cấu hình màu Dark Mode (Đồng bộ với các file khác)
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'primary': '#60a5fa', // Blue-400
                    'dark-bg-body': '#262626',
                    'dark-bg-card': '#333333', // Sử dụng cho header
                    'dark-border': '#4b5563', // Gray-600
                },
                fontFamily: {
                    sans: ['Inter', 'sans-serif'],
                },
            }
        }
    }
</script>

<!-- Sử dụng bg-dark-bg-card cho nền header, sticky top-0 để cố định -->
<header class="bg-dark-bg-card shadow-xl sticky top-0 z-50 border-b border-dark-border">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center flex-wrap md:flex-nowrap">
        
        <!-- Logo -->
        <a href="{% url 'home' %}" class="text-2xl font-bold text-primary mr-6 tracking-wider">WebStory</a>
        
        <!-- Nav Menu -->
        <nav class="order-3 md:order-2 w-full md:w-auto md:flex-grow">
            <ul class="flex space-x-4 text-sm font-medium mt-3 md:mt-0 justify-center md:justify-start">
                <li><a href="{% url 'home' %}" class="text-gray-300 hover:text-primary transition duration-150">Home</a></li>
                <li><a href="{% url 'stories' %}" class="text-gray-300 hover:text-primary transition duration-150">Stories</a></li>
                <li><a href="{% url 'categories' %}" class="text-gray-300 hover:text-primary transition duration-150">Categories</a></li>
            </ul>
        </nav>
        
        <!-- Search and Actions -->
        <div class="header-actions order-2 md:order-3 flex items-center space-x-4">
            
            <!-- Thanh tìm kiếm -->
            <form action="{% url 'search' %}" method="get" class="relative">
                <input type="search" name="q" placeholder="Tìm kiếm truyện..." 
                       class="w-32 sm:w-48 px-3 py-2 text-sm bg-gray-700 border border-dark-border rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-primary transition duration-200">
                <button type="submit" class="absolute right-0 top-0 mt-2 mr-2 text-gray-400 hover:text-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </button>
            </form>

            <!-- LOGIC KIỂM TRA ĐĂNG NHẬP -->
            {% if user.is_authenticated %}
            
                <!-- Người dùng đã đăng nhập: Hiển thị Profile Link và Avatar -->
                <a href="{% url 'profile' %}" class="flex items-center space-x-2 p-1.5 rounded-lg hover:bg-gray-700 transition duration-200">
                    
                    <!-- Avatar (Giả định: user.profile.avatar_url chứa link ảnh) -->
                    <!-- Nếu không có ảnh, dùng ảnh default (Placeholder SVG) -->
                    <img class="h-8 w-8 rounded-full object-cover" 
                         src="{{ user.profile.avatar_url|default:'https://placehold.co/32x32/60a5fa/ffffff?text=U' }}" 
                         alt="{{ user.username }} Avatar"
                         onerror="this.onerror=null;this.src='https://placehold.co/32x32/60a5fa/ffffff?text=U'">

                    <!-- Username -->
                    <span class="hidden sm:inline-block text-sm font-semibold text-white">
                        {{ user.username }}
                    </span>
                </a>
                
                <!-- Nút Đăng xuất -->
                <a href="{% url 'logout' %}" 
                   class="px-3 py-1.5 text-sm font-semibold bg-red-600 text-white rounded-lg shadow-md hover:bg-red-700 transition duration-200">
                    Logout
                </a>

            {% else %}
            
                <!-- Người dùng CHƯA đăng nhập: Hiển thị Sign In và Log in -->
                
                <!-- Nút Sign In (Register) -->
                <a href="{% url 'register' %}" 
                   class="hidden sm:inline-block px-3 py-1.5 text-sm font-semibold border border-primary text-primary rounded-lg hover:bg-primary hover:text-white transition duration-200">
                    Sign In
                </a>
                
                <!-- Nút Log in -->
                <a href="{% url 'login' %}" 
                   class="px-3 py-1.5 text-sm font-semibold bg-primary text-white rounded-lg shadow-md hover:bg-blue-500 transition duration-200">
                    Log in
                </a>
            
            {% endif %}

        </div>
    </div>
</header>
